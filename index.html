<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<meta name="theme-color" content="#050b14" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Brisa Lounge Bar</title>

<!-- Fontes Modernas -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

<style>
/* --- VARI√ÅVEIS & RESET --- */
:root {
  --bg-body: #050b14;
  --bg-card: #0e1623;
  --bg-header: rgba(5, 11, 20, 0.95);
  --text-main: #f0f4f8;
  --text-muted: #94a3b8;
  --gold: #d4af37; /* Dourado cl√°ssico do PDF */
  --gold-glow: #fceabb;
  --danger: #ef4444;
  --success: #10b981;
  --radius: 16px;
  --shadow: 0 4px 20px rgba(0,0,0,0.4);
  --font-main: 'Inter', sans-serif;
  --font-display: 'Playfair Display', serif;
  --safe-area-bottom: env(safe-area-inset-bottom);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { margin: 0; padding: 0; height: 100%; font-family: var(--font-main); background-color: var(--bg-body); color: var(--text-main); }

/* --- ESTRUTURA --- */
.app {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  padding-bottom: calc(100px + var(--safe-area-bottom)); /* Espa√ßo extra para scroll final */
}

/* --- HEADER --- */
header {
  position: sticky;
  top: 0;
  z-index: 50;
  background: var(--bg-header);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 16px 20px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.brand-row {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 16px;
}

.logo {
  width: 48px;
  height: 48px;
  background: linear-gradient(135deg, var(--gold), #b8860b);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-display);
  font-size: 24px;
  color: #000;
  font-weight: bold;
  box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
  cursor: pointer;
  user-select: none;
  transition: transform 0.2s;
}
.logo:active { transform: scale(0.95); }

.brand-info h1 {
  margin: 0;
  font-family: var(--font-display);
  font-size: 22px;
  color: var(--gold);
  letter-spacing: 0.5px;
}

.brand-info p {
  margin: 4px 0 0 0;
  font-size: 13px;
  color: var(--text-muted);
}

/* --- BUSCA --- */
.search-container {
  position: relative;
}
.search-input {
  width: 100%;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  padding: 12px 16px 12px 44px;
  border-radius: 12px;
  color: #fff;
  font-size: 15px;
  font-family: var(--font-main);
  outline: none;
  transition: border-color 0.2s, background 0.2s;
}
.search-input:focus { border-color: var(--gold); background: rgba(255,255,255,0.08); }
.search-icon {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  pointer-events: none;
}

/* --- LISTA DE ITENS --- */
main { padding: 20px; width: 100%; max-width: 800px; margin: 0 auto; }

.category-section {
  margin-bottom: 32px;
  animation: fadeIn 0.5s ease;
}

.cat-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-bottom: 14px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
}

.cat-title {
  font-family: var(--font-display);
  font-size: 20px;
  color: var(--text-main);
  margin: 0;
}

.cat-count { font-size: 12px; color: var(--gold); font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }

.item-card {
  background: var(--bg-card);
  border-radius: var(--radius);
  padding: 16px;
  margin-bottom: 12px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 16px;
  border: 1px solid rgba(255,255,255,0.03);
  transition: transform 0.2s, background 0.2s;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.item-card:active { transform: scale(0.98); background: rgba(255,255,255,0.08); }

.item-content { flex: 1; }
.item-name { font-weight: 600; font-size: 16px; margin-bottom: 6px; color: #fff; line-height: 1.3; }
.item-desc { font-size: 13px; color: var(--text-muted); line-height: 1.4; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; }

.item-price {
  font-weight: 700;
  color: var(--gold);
  font-size: 16px;
  white-space: nowrap;
  background: rgba(212, 175, 55, 0.1);
  padding: 6px 10px;
  border-radius: 8px;
  text-align: right;
}

/* --- ADMIN UI (FIXA) --- */
.admin-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(10, 15, 25, 0.98);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border-top: 1px solid rgba(212, 175, 55, 0.3);
  padding: 12px 20px;
  padding-bottom: max(12px, var(--safe-area-bottom));
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 999; /* Garante que fique acima de tudo */
  transform: translateY(150%);
  transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: 0 -4px 20px rgba(0,0,0,0.5);
}

.is-admin .admin-bar { transform: translateY(0); }
.is-admin .app { padding-bottom: 160px; } /* Empurra o conte√∫do pra cima */

.admin-actions { display: flex; gap: 10px; overflow-x: auto; padding-right: 10px; }
.admin-actions::-webkit-scrollbar { display: none; }

.btn {
  border: none;
  border-radius: 10px;
  padding: 10px 16px;
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: filter 0.2s;
  font-family: var(--font-main);
}

.btn-primary { background: var(--gold); color: #000; }
.btn-outline { background: transparent; border: 1px solid rgba(255,255,255,0.2); color: #fff; }
.btn-danger { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.3); }
.btn:active { filter: brightness(0.9); }

/* A√ß√µes flutuantes nos cards (Admin) */
.admin-card-actions {
  display: none;
  position: absolute;
  top: 8px;
  right: 8px;
  gap: 6px;
  background: rgba(0,0,0,0.6);
  padding: 4px;
  border-radius: 20px;
}
.is-admin .item-card:hover .admin-card-actions, 
.is-admin .item-card:focus-within .admin-card-actions { display: flex; }
/* Em mobile, sempre mostrar bot√µes de admin nos cards */
@media (hover: none) { .is-admin .admin-card-actions { display: flex; } }

.btn-icon { width: 32px; height: 32px; padding: 0; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: var(--bg-body); border: 1px solid var(--gold); color: var(--gold); font-size: 16px; }

/* --- MODAL --- */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  z-index: 1000;
  display: none;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s;
  padding: 20px;
}
.modal-backdrop.active { display: flex; opacity: 1; }

.modal {
  background: #151e2e;
  width: 100%;
  max-width: 500px;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  max-height: 90vh;
  animation: slideUp 0.3s ease;
}

@media (max-width: 600px) {
  .modal-backdrop { align-items: flex-end; padding: 0; }
  .modal { border-radius: 24px 24px 0 0; border-bottom: none; max-height: 85vh; width: 100%; }
}

.modal-header { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2); }
.modal-title { font-family: var(--font-display); font-size: 20px; margin: 0; color: var(--gold); }
.modal-close { background: none; border: none; color: var(--text-muted); font-size: 28px; cursor: pointer; padding: 0 8px; line-height: 1; }

.modal-body { padding: 24px; overflow-y: auto; }
.modal-price-big { font-size: 28px; color: var(--gold); font-weight: 700; margin-top: 10px; text-align: right; }

.form-group { margin-bottom: 16px; }
.form-label { display: block; margin-bottom: 6px; font-size: 13px; color: var(--text-muted); }
.form-input, .form-textarea, .form-select {
  width: 100%;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.1);
  padding: 12px;
  border-radius: 10px;
  color: #fff;
  font-family: inherit;
  font-size: 15px;
}
.form-input:focus { border-color: var(--gold); outline: none; }

.modal-footer { padding: 16px 24px; border-top: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: flex-end; gap: 12px; background: rgba(0,0,0,0.2); padding-bottom: max(16px, var(--safe-area-bottom)); }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

.empty-state { text-align: center; padding: 40px; color: var(--text-muted); font-style: italic; }
</style>
</head>
<body>

<div class="app">
  <header>
    <div class="brand-row">
      <!-- O logo √© o "bot√£o secreto" para admin -->
      <div id="logoBtn" class="logo" title="Toque 7 vezes para Admin">B</div>
      <div class="brand-info">
        <h1>Brisa Lounge Bar</h1>
        <p>Menu Digital</p>
      </div>
    </div>
    <div class="search-container">
      <span class="search-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
      </span>
      <input type="text" id="searchInput" class="search-input" placeholder="O que vamos beber hoje? (ex: Gin, Heineken)">
    </div>
  </header>

  <main id="menuList">
    <!-- Lista gerada via JS -->
  </main>
</div>

<!-- BARRA DE ADMINISTRA√á√ÉO FIXA -->
<div class="admin-bar" id="adminBar">
  <div style="display:flex; align-items:center; gap:10px;">
    <div style="background:var(--success);width:8px;height:8px;border-radius:50%"></div>
    <span style="font-size:12px; color:var(--text-muted); font-weight:bold; line-height:1.2">MODO<br>ADMIN</span>
    <div style="height:30px; width:1px; background:rgba(255,255,255,0.1); margin-left:8px;"></div>
  </div>
  <div class="admin-actions">
    <button class="btn btn-primary" onclick="openAddModal()">
      <span>+</span> Novo Item
    </button>
    <button class="btn btn-outline" onclick="addNewCategory()">Nova Se√ß√£o</button>
    <button class="btn btn-outline" onclick="exportData()">Backup</button>
    <button class="btn btn-danger" onclick="toggleAdmin(false)">Sair</button>
  </div>
</div>

<!-- MODAL GERAL (Backdrop) -->
<div id="modalOverlay" class="modal-backdrop">
  <div class="modal" id="modalContent">
    <!-- Conte√∫do injetado via JS -->
  </div>
</div>

<script>
/**
 * BRISA LOUNGE BAR - CARD√ÅPIO DIGITAL
 * Vers√£o Revisada & Corrigida
 */

// --- DADOS INICIAIS (Baseado no PDF fornecido) ---
const INITIAL_DATA = {
  categories: [
    {
      id: 'cat_drinks', name: 'Drinks Brisa', items: [
        { id: 'dk1', name: 'Caipirinha de Cacha√ßa (300ml)', price: 15.00, desc: 'Escolha: Morango ou Lim√£o.' },
        { id: 'dk2', name: 'Caipirinha de Vodka/Saqu√™ (300ml)', price: 20.00, desc: 'Escolha: Morango ou Lim√£o.' },
        { id: 'dk3', name: 'Caipirinha Gourmet Brisa', price: 35.00, desc: 'Especial da casa. Escolha: Morango ou Lim√£o.' },
        { id: 'dk4', name: 'Gin Eternity (500ml)', price: 10.00, desc: 'Sabores: Melancia, Tropical, Ma√ß√£ Verde ou Royale.' },
        { id: 'dk5', name: 'Gin Eternity (700ml)', price: 15.00, desc: 'Sabores: Melancia, Tropical, Ma√ß√£ Verde ou Royale.' },
        { id: 'dk6', name: 'Gin Premium & Red Bull', price: 30.00, desc: 'Com fruta. Escolha: Melancia ou Tropical.' },
        { id: 'dk7', name: 'Cop√£o Premium & Red Bull', price: 40.00, desc: 'Copo grande com fruta. Escolha: Melancia ou Tropical.' },
        { id: 'dk8', name: 'Moscow Mule Tradicional', price: 30.00, desc: 'Vodka, ginger beer, lim√£o e espuma.' }
      ]
    },
    {
      id: 'cat_combos', name: 'Combos & Garrafas', items: [
        { id: 'cb1', name: 'Jack Daniel\'s Tradicional', price: 280.00, desc: 'Garrafa + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb2', name: 'Jack Daniel\'s Sabores', price: 300.00, desc: 'Garrafa (Honey, Fire ou Apple) + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb3', name: 'Chivas 12 Anos', price: 250.00, desc: 'Garrafa + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb4', name: 'Black Label', price: 320.00, desc: 'Garrafa + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb5', name: 'White Horse', price: 200.00, desc: 'Garrafa + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb6', name: 'Gin Tanqueray', price: 250.00, desc: 'Garrafa + Frutas + 4 Red Bull ou 5 T√¥nicas.' },
        { id: 'cb7', name: 'Ciroc Tradicional', price: 320.00, desc: 'Garrafa + 4 Gelos de Sabor + 4 Red Bull.' },
        { id: 'cb8', name: 'Combo Malibu', price: 120.00, desc: 'Garrafa. Observa√ß√£o: Energ√©tico Bally.' }
      ]
    },
    {
      id: 'cat_doses', name: 'Doses & Bebidas', items: [
        { id: 'ds1', name: 'Malibu (Dose)', price: 30.00, desc: '' },
        { id: 'ds2', name: 'Smirnoff + Energ√©tico', price: 20.00, desc: 'Observa√ß√£o: Energ√©tico Bally.' },
        { id: 'ds3', name: 'Absolut + Red Bull', price: 40.00, desc: '' },
        { id: 'ds4', name: 'White Horse + Energ√©tico', price: 25.00, desc: 'Observa√ß√£o: Energ√©tico Bally.' },
        { id: 'ds5', name: 'Red Label + Energ√©tico', price: 30.00, desc: 'Observa√ß√£o: Energ√©tico Bally.' },
        { id: 'ds6', name: 'Jack Daniel\'s + Red Bull', price: 50.00, desc: '' },
        { id: 'ds7', name: 'Jack Daniel\'s Ma√ß√£ Verde + Red Bull', price: 55.00, desc: '' },
        { id: 'ds8', name: 'Licor 43 (Dose)', price: 18.00, desc: '' },
        { id: 'ds9', name: 'Licor Ballena (Dose)', price: 18.00, desc: '' },
        { id: 'ds10', name: 'Tequila Jos√© Cuervo (Dose)', price: 18.00, desc: '' },
        { id: 'ds11', name: 'Jack Daniel\'s (Dose)', price: 30.00, desc: '' }
      ]
    },
    {
      id: 'cat_beers', name: 'Cervejas & Long Necks', items: [
        { id: 'br1', name: 'Original (600ml)', price: 15.00, desc: 'Garrafa gelada.' },
        { id: 'br2', name: 'Spaten (600ml)', price: 17.00, desc: 'Puro malte.' },
        { id: 'br3', name: 'Heineken (600ml)', price: 19.00, desc: 'Premium.' },
        { id: 'br4', name: 'Balde Original (4 un)', price: 56.00, desc: '4 Garrafas de 600ml.' },
        { id: 'br5', name: 'Balde Spaten (4 un)', price: 64.00, desc: '4 Garrafas de 600ml.' },
        { id: 'br6', name: 'Balde Heineken (4 un)', price: 72.00, desc: '4 Garrafas de 600ml.' },
        { id: 'br7', name: 'Budweiser (Long Neck)', price: 8.00, desc: '' },
        { id: 'br8', name: 'Spaten (Long Neck)', price: 10.00, desc: '' },
        { id: 'br9', name: 'Corona (Long Neck)', price: 12.00, desc: '' },
        { id: 'br10', name: 'Heineken (Long Neck)', price: 12.00, desc: '' },
        { id: 'br11', name: 'Heineken 0% (Long Neck)', price: 12.00, desc: 'Sem √°lcool.' },
        { id: 'br12', name: 'Skol Beats', price: 12.00, desc: '' },
        { id: 'br13', name: 'Smirnoff Ice', price: 12.00, desc: '' },
        { id: 'br14', name: 'Balde Heineken Long (10 un)', price: 110.00, desc: '10 unidades no gelo.' }
      ]
    },
    {
      id: 'cat_misc', name: 'Diversos', items: [
        { id: 'm1', name: '√Ågua (Com ou Sem G√°s)', price: 5.00, desc: '' },
        { id: 'm2', name: '√Ågua T√¥nica', price: 6.00, desc: '' },
        { id: 'm3', name: 'Refrigerante / Suco (Lata)', price: 6.00, desc: 'Coca, Guaran√°, Sprite, Fanta, Del Valle.' },
        { id: 'm4', name: 'Red Bull Sabores', price: 12.00, desc: '' },
        { id: 'm5', name: 'Halls / Trident', price: 3.00, desc: '' },
        { id: 'm6', name: 'Gelo (Adicional/Copo)', price: 3.50, desc: '' },
        { id: 'm7', name: 'Snickers', price: 6.00, desc: '' }
      ]
    },
    {
      id: 'cat_hookah', name: 'Narguil√©', items: [
        { id: 'hk1', name: 'Rosh (Refil de Ess√™ncia)', price: 15.00, desc: 'Sess√£o.' },
        { id: 'hk2', name: 'Aluguel do Narguil√©', price: 5.00, desc: 'Taxa cobrada no primeiro uso/aluguel do equipamento.' }
      ]
    },
    {
      id: 'cat_food', name: 'Por√ß√µes, Caldos & T√°buas', items: [
        { id: 'fd1', name: 'Batata com Cheddar e Bacon', price: 35.00, desc: '' },
        { id: 'fd2', name: 'Onion Rings', price: 30.00, desc: 'An√©is de cebola empanados.' },
        { id: 'fd3', name: 'Salgados Fritos', price: 25.00, desc: 'Coxinha, bolinha de queijo, etc.' },
        { id: 'fd4', name: 'Calabresa Acebolada', price: 25.00, desc: '' },
        { id: 'fd5', name: 'Por√ß√£o Mista', price: 40.00, desc: 'Escolha 2 itens (Exceto Peixe).' },
        { id: 'fd6', name: 'Isca de Peixe', price: 60.00, desc: 'Acompanha molho t√°rtaro.' },
        { id: 'fd7', name: 'Frango a Passarinho', price: 35.00, desc: 'Bem temperado.' },
        { id: 'fd8', name: 'Por√ß√£o Completa', price: 120.00, desc: 'Acompanha isca de peixe + 2 op√ß√µes √† sua escolha.' },
        { id: 'fd9', name: 'Caldo Verde (500ml)', price: 18.00, desc: '' },
        { id: 'fd10', name: 'Caldo de Feij√£o (500ml)', price: 18.00, desc: '' },
        { id: 'fd11', name: 'Caldo de Mocot√≥ (500ml)', price: 20.00, desc: '' },
        { id: 'fd12', name: 'Ab√≥bora com Carne Seca (500ml)', price: 20.00, desc: '' },
        { id: 'fd13', name: 'T√°bua Picanha com Batata', price: 100.00, desc: 'Aprox 600g de Picanha + Molho da casa, barbecue, vinagrete e farofa.' },
        { id: 'fd14', name: 'T√°bua Lingui√ßa com Aligot', price: 70.00, desc: 'Aprox 500g de Lingui√ßa + Molho da casa, vinagrete e farofa.' }
      ]
    }
  ]
};

// --- ESTADO & PERSIST√äNCIA ---
const LS_KEY = 'brisa_menu_v3'; // Chave atualizada para v3
let data = loadData();
let isAdmin = false;

function loadData() {
  try {
    const saved = localStorage.getItem(LS_KEY);
    return saved ? JSON.parse(saved) : INITIAL_DATA;
  } catch(e) {
    return INITIAL_DATA;
  }
}

function saveData() {
  localStorage.setItem(LS_KEY, JSON.stringify(data));
  renderMenu();
}

function exportData() {
  const blob = new Blob([JSON.stringify(data, null, 2)], {type : 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `brisa_backup_${new Date().toLocaleDateString('pt-BR').replace(/\//g,'-')}.json`;
  a.click();
}

// --- RENDERIZA√á√ÉO ---
const menuListEl = document.getElementById('menuList');
const searchInput = document.getElementById('searchInput');

function formatCurrency(val) {
  if (val === undefined || val === null) return 'R$ 0,00';
  return Number(val).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
}

function renderMenu() {
  menuListEl.innerHTML = '';
  const term = searchInput.value.toLowerCase();
  let hasContent = false;

  data.categories.forEach(cat => {
    // Filtra itens
    const filteredItems = cat.items.filter(item => 
      item.name.toLowerCase().includes(term) || 
      (item.desc && item.desc.toLowerCase().includes(term))
    );

    if (filteredItems.length === 0) return;
    hasContent = true;

    // Cria se√ß√£o
    const section = document.createElement('section');
    section.className = 'category-section';
    
    // Header da Se√ß√£o
    const header = document.createElement('div');
    header.className = 'cat-header';
    header.innerHTML = `
      <div>
        <h2 class="cat-title">${cat.name}</h2>
        <span class="cat-count">${filteredItems.length} op√ß√µes</span>
      </div>
      ${isAdmin ? `
        <div class="admin-card-actions" style="position:static; display:flex; background:transparent;">
           <button class="btn btn-icon" style="border-color:var(--danger); color:var(--danger)" onclick="deleteCategory('${cat.id}')">üóë</button>
        </div>
      ` : ''}
    `;
    section.appendChild(header);

    // Itens
    filteredItems.forEach(item => {
      const card = document.createElement('article');
      card.className = 'item-card';
      // Clique no card abre modal de detalhes
      card.onclick = (e) => {
        if(e.target.closest('button')) return; // Ignora clique se for nos bot√µes de admin
        openItemModal(item);
      };

      card.innerHTML = `
        <div class="item-content">
          <div class="item-name">${item.name}</div>
          <div class="item-desc">${item.desc || 'Toque para ver detalhes'}</div>
        </div>
        <div class="item-price">${formatCurrency(item.price)}</div>
        
        ${isAdmin ? `
          <div class="admin-card-actions">
            <button class="btn btn-icon" onclick="openEditModal('${cat.id}', '${item.id}')">‚úé</button>
            <button class="btn btn-icon" style="border-color:var(--danger); color:var(--danger)" onclick="deleteItem('${cat.id}', '${item.id}')">‚úï</button>
          </div>
        ` : ''}
      `;
      section.appendChild(card);
    });

    menuListEl.appendChild(section);
  });

  if (!hasContent) {
    menuListEl.innerHTML = `<div class="empty-state">Nenhum item encontrado para "${searchInput.value}"</div>`;
  }
}

searchInput.addEventListener('input', renderMenu);

// --- MODALS (Visualiza√ß√£o & Edi√ß√£o) ---
const modalOverlay = document.getElementById('modalOverlay');
const modalContent = document.getElementById('modalContent');

function closeModal() {
  modalOverlay.classList.remove('active');
  // Limpa o conte√∫do ap√≥s a anima√ß√£o de sa√≠da (300ms)
  setTimeout(() => { modalContent.innerHTML = ''; }, 300);
}

// Fechar ao clicar fora
modalOverlay.addEventListener('click', (e) => {
  if (e.target === modalOverlay) closeModal();
});

function openItemModal(item) {
  modalContent.innerHTML = `
    <div class="modal-header">
      <h3 class="modal-title">Detalhes do Item</h3>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <h2 style="color:var(--gold); margin-top:0; line-height:1.2; font-family:var(--font-display)">${item.name}</h2>
      <p style="color:var(--text-muted); font-size:16px; line-height:1.5; margin-bottom:20px;">
        ${item.desc || 'Sem descri√ß√£o adicional.'}
      </p>
      <div style="height:1px; background:rgba(255,255,255,0.1); margin:10px 0;"></div>
      <div class="modal-price-big">${formatCurrency(item.price)}</div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" style="width:100%; justify-content:center" onclick="closeModal()">Voltar ao Menu</button>
    </div>
  `;
  modalOverlay.classList.add('active');
}

// --- L√ìGICA DE ADMIN (CRUD) ---

// Abrir modal de EDI√á√ÉO ou CRIA√á√ÉO
function openEditModal(catId, itemId = null) {
  const category = data.categories.find(c => c.id === catId);
  if (!category) return;

  const isNew = !itemId;
  // Se for novo, cria objeto vazio. Se for edi√ß√£o, clona o item existente.
  const item = itemId 
    ? { ...category.items.find(i => i.id === itemId) } 
    : { name:'', price:'', desc:'' };

  modalContent.innerHTML = `
    <div class="modal-header">
      <h3 class="modal-title">${isNew ? 'Novo Item' : 'Editar Item'}</h3>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Nome do Item</label>
        <input type="text" id="inpName" class="form-input" value="${item.name}" placeholder="Ex: Gin T√¥nica">
      </div>
      <div class="form-group">
        <label class="form-label">Pre√ßo (R$)</label>
        <input type="number" id="inpPrice" class="form-input" value="${item.price}" placeholder="0.00" step="0.50">
      </div>
      <div class="form-group">
        <label class="form-label">Descri√ß√£o / Ingredientes</label>
        <textarea id="inpDesc" class="form-textarea" rows="4" placeholder="Ex: Acompanha gelo de sabor...">${item.desc || ''}</textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal()">Cancelar</button>
      <button class="btn btn-primary" onclick="saveItem('${catId}', '${itemId || ''}')">Salvar Altera√ß√µes</button>
    </div>
  `;
  modalOverlay.classList.add('active');
}

function openAddModal() {
  if (data.categories.length === 0) {
    alert("Crie uma se√ß√£o primeiro!");
    return;
  }
  
  // Modal para escolher categoria antes de criar item
  let catOptions = data.categories.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
  
  modalContent.innerHTML = `
    <div class="modal-header">
      <h3 class="modal-title">Adicionar onde?</h3>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Selecione a Categoria</label>
        <select id="selCat" class="form-select">${catOptions}</select>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" style="width:100%; justify-content:center" onclick="goToCreateItem()">Continuar</button>
    </div>
  `;
  modalOverlay.classList.add('active');
}

function goToCreateItem() {
  const catId = document.getElementById('selCat').value;
  closeModal(); // Fecha o modal de sele√ß√£o
  setTimeout(() => openEditModal(catId), 300); // Abre o de cria√ß√£o
}

function saveItem(catId, itemId) {
  const name = document.getElementById('inpName').value.trim();
  const priceVal = document.getElementById('inpPrice').value;
  const price = priceVal ? parseFloat(priceVal) : 0;
  const desc = document.getElementById('inpDesc').value.trim();

  if (!name) return alert('O nome do item √© obrigat√≥rio.');

  const catIndex = data.categories.findIndex(c => c.id === catId);
  if (catIndex === -1) return;

  if (itemId) {
    // Modo Edi√ß√£o
    const itemIndex = data.categories[catIndex].items.findIndex(i => i.id === itemId);
    if (itemIndex > -1) {
      data.categories[catIndex].items[itemIndex] = { id: itemId, name, price, desc };
    }
  } else {
    // Modo Cria√ß√£o
    const newItem = {
      id: 'it_' + Date.now() + Math.random().toString(36).substr(2, 5),
      name, price, desc
    };
    data.categories[catIndex].items.push(newItem);
  }

  saveData();
  closeModal();
}

function deleteItem(catId, itemId) {
  if(!confirm('Tem certeza que deseja apagar este item?')) return;
  const cat = data.categories.find(c => c.id === catId);
  if(cat) {
    cat.items = cat.items.filter(i => i.id !== itemId);
    saveData();
  }
}

function addNewCategory() {
  const name = prompt('Nome da nova se√ß√£o (Ex: Vinhos):');
  if(name && name.trim()) {
    data.categories.push({ 
      id: 'cat_' + Date.now(), 
      name: name.trim(), 
      items: [] 
    });
    saveData();
  }
}

function deleteCategory(catId) {
  if(!confirm('ATEN√á√ÉO: Isso apagar√° a se√ß√£o inteira e todos os itens dela. Continuar?')) return;
  data.categories = data.categories.filter(c => c.id !== catId);
  saveData();
}

// --- AUTENTICA√á√ÉO E ADMIN ---
const ADMIN_PASS = 'brisa2026';
const logoBtn = document.getElementById('logoBtn');

// L√≥gica de "7 toques"
let tapCount = 0;
let tapTimer;

logoBtn.addEventListener('click', (e) => {
  e.preventDefault();
  tapCount++;
  
  // Feedback visual de toque (vibra√ß√£o leve se suportado ou console)
  if(navigator.vibrate) navigator.vibrate(50);
  
  clearTimeout(tapTimer);
  
  if (tapCount === 7) {
    tapCount = 0;
    askAdmin();
  } else {
    tapTimer = setTimeout(() => { tapCount = 0; }, 600);
  }
});

// L√≥gica de "Long Press" (Segurar por 3s)
let longPressTimer;
logoBtn.addEventListener('touchstart', (e) => {
  // e.preventDefault(); // Comentado para permitir scroll se necess√°rio
  longPressTimer = setTimeout(() => {
    if(navigator.vibrate) navigator.vibrate(200);
    askAdmin();
  }, 3000); 
}, {passive: true});

logoBtn.addEventListener('touchend', () => { 
  clearTimeout(longPressTimer); 
});

logoBtn.addEventListener('mousedown', () => { 
  longPressTimer = setTimeout(askAdmin, 3000); 
});
logoBtn.addEventListener('mouseup', () => { 
  clearTimeout(longPressTimer); 
});

function askAdmin() {
  if (isAdmin) return; // J√° est√° logado
  
  // Pequeno delay para evitar conflito de UI
  setTimeout(() => {
    const pass = prompt('√Årea Administrativa\nDigite a senha:');
    if (pass === ADMIN_PASS) {
      toggleAdmin(true);
      alert('Modo Admin Ativado!\nUse a barra inferior para editar.');
    } else if (pass !== null) {
      alert('Senha incorreta.');
    }
  }, 100);
}

function toggleAdmin(status) {
  isAdmin = status;
  document.body.classList.toggle('is-admin', status);
  renderMenu();
}

// Inicializa√ß√£o
window.addEventListener('load', () => {
  renderMenu();
  console.log('Brisa Lounge Menu Carregado');
});

</script>
</body>
</html>
